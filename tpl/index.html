<include target="header.html" />

<form action="./" method="post" class="x_form-horizontal" autocomplete="off">
    <input type="hidden" name="module" value="mbti" />
    <input type="hidden" name="act" value="procMbtiAdminInsertConfig" />
    <input type="hidden" name="success_return_url" value="{getRequestUriByServerEnviroment()}" />

    <section class="section">
        <h1>기본 설정</h1>

        <div class="x_control-group">
            <label class="x_control-label" for="point_cost">필요 캡슐(포인트)</label>
            <div class="x_controls">
                <input type="number" id="point_cost" name="point_cost" value="{$config->point_cost}"
                    style="width:100px;" />
                <p class="x_help-inline">검사를 최종 제출할 때 회원에게서 차감할 캡슐(포인트) 수량을 입력하세요. (기본 500)</p>
            </div>
        </div>

        <div class="x_control-group">
            <label class="x_control-label" for="show_stats">통계 노출 여부</label>
            <div class="x_controls">
                <select name="show_stats" id="show_stats">
                    <option value="Y" <!--@if($config->show_stats != 'N')-->selected="selected"<!--@end-->>노출함</option>
                    <option value="N" <!--@if($config->show_stats == 'N')-->selected="selected"<!--@end-->>숨김</option>
                </select>
                <p class="x_help-inline">메인 페이지 등에 전체 커뮤니티 MBTI 통계 차트를 보여줄지 설정합니다.</p>
            </div>
        </div>

        <div class="x_control-group">
            <label class="x_control-label">이용 가능 회원 그룹</label>
            <div class="x_controls">
                <!--@foreach($group_list as $group_srl => $group)-->
                <label class="x_inline">
                    <input type="checkbox" name="allowed_groups[]" value="{$group_srl}" <!--@if(in_array($group_srl,
                        $config->allowed_groups))-->checked="checked"<!--@end--> />
                    {$group->title}
                </label>
                <!--@end-->
                <p class="x_help-block" style="margin-top: 5px;">선택 항목이 없으면 <strong>모든 회원</strong>이 검사를 이용할 수 있습니다. 특정
                    그룹만 이용하게 하려면 해당 그룹을 체크하세요.</p>
            </div>
        </div>
    </section>

    <!--@if($mbti_stats && count($mbti_stats) > 0)-->
    <section class="section">
        <h1>커뮤니티 MBTI 분포 상세 (관리자용) - 총 {$mbti_total_count}명 참여</h1>
        <div style="margin:20px 0;">
            <div
                style="width: 100%; max-width: 600px; height: 36px; background: #f1f5f9; border-radius: 20px; box-shadow: inset 0 2px 4px rgba(0,0,0,0.05); overflow: hidden; display: flex;">
                <!--@foreach($mbti_stats as $stat)-->
                <div style="height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background-position: center; background-size: cover; white-space: nowrap; overflow: hidden; font-size: 0.8rem; font-weight: 700; color: white; text-shadow: 0 1px 2px rgba(0,0,0,0.5); border-right: 1px solid rgba(255,255,255,0.2); transition: all 0.3s ease; width: {$stat->percent}%; background-color: var(--mbti-primary, #6366f1);"
                    title="{$stat->mbti_type} ({$stat->count}명, {$stat->percent}%)">
                    <span>{$stat->mbti_type}</span>
                </div>
                <!--@end-->
            </div>
            <p class="x_help-block" style="margin-top:10px;">막대에 마우스를 올리면 각 유형의 정확한 사람 수(명)와 비율(%)을 확인할 수 있습니다.</p>
        </div>
    </section>
    <!--@end-->

    <div class="x_clearfix btnArea">
        <button type="submit" class="x_btn x_btn-primary">{$lang->cmd_save}</button>
    </div>
</form>